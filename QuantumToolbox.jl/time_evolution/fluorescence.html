<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Li-Xun Cai">
<meta name="dcterms.date" content="2025-01-27">

<title>Resonance fluorescence â€“ Tutorials for Quantum Toolbox in Julia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-57476271c5f0467c372e20ff5d25630e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-391c4f7f0df7475a7487d1067a5e1fc7.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8cddf1564d0ae74a4a5761cb3bc5d764.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-48c97925b0c5967516ef08ff0884cb9b.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/logo.png" alt="QuantumToolbox logo." class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tutorials for Quantum Toolbox in Julia</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../QuantumToolbox.jl/toc.html"> 
<span class="menu-text">QuantumToolbox.jl</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../HierarchicalEOM.jl/toc.html"> 
<span class="menu-text">HierarchicalEOM.jl</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/qutip/qutip-julia-tutorials" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#dissipation-dynamics" id="toc-dissipation-dynamics" class="nav-link" data-scroll-target="#dissipation-dynamics">Dissipation dynamics</a></li>
  </ul></li>
  <li><a href="#code-demonstration" id="toc-code-demonstration" class="nav-link" data-scroll-target="#code-demonstration">Code Demonstration</a></li>
  <li><a href="#version-information" id="toc-version-information" class="nav-link" data-scroll-target="#version-information">Version Information</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/qutip/qutip-julia-tutorials/edit/main/QuantumToolbox.jl/time_evolution/fluorescence.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/qutip/qutip-julia-tutorials/blob/main/QuantumToolbox.jl/time_evolution/fluorescence.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/qutip/qutip-julia-tutorials/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Resonance fluorescence</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Li-Xun Cai </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Last Update</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-01-27</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Inspirations taken from <a href="https://nbviewer.org/urls/qutip.org/qutip-tutorials/tutorials-v5/lectures/Lecture-13-Resonance-flourescence.ipynb">this QuTiP tutorial</a> by J. R. Johansson.</p>
<p>In this tutorial, we demonstrate the following functionalities:</p>
<ul>
<li><a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.liouvillian"><code>liouvillian</code></a></li>
<li><a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.mesolve"><code>mesolve</code></a></li>
<li><a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.correlation_2op_1t"><code>correlation_2op_1t</code></a><br>
</li>
<li><a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.spectrum_correlation_fft"><code>spectrum_correlation_fft</code></a></li>
</ul>
<p>with the example of resonance fluorescence in the weak field limit. We also adopt the convention <span class="math inline">\(\hbar = 1\)</span> throughout this tutorial.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Resonance fluorescence is the radiative behavior of a two-level atom driven by a resonant light mode in a coherent state (usually a monochromatic laser beam). The Hamiltonian <span class="math inline">\(H\)</span> is given by</p>
<ul>
<li><span class="math inline">\(H_\text{a} = \frac{\omega_a}{2} \hat{\sigma}_z\)</span></li>
<li><span class="math inline">\(H_\text{drv} = \Omega \cos(\omega_L t) (\hat{\sigma}^{+} + \hat{\sigma}^{-})\)</span></li>
</ul>
<p>with</p>
<ul>
<li><span class="math inline">\(\omega_a\)</span>: Frequency of the two-level atom</li>
<li><span class="math inline">\(\omega_L\)</span>: Frequency of the light field</li>
<li><span class="math inline">\(\Omega\)</span>: Field strength of the light field</li>
<li><span class="math inline">\(\hat{\sigma}_{x,y,z}\)</span>: Pauli matrices</li>
<li><span class="math inline">\(\hat{\sigma}^{\pm}\)</span>: Raising (<span class="math inline">\(+\)</span>) and lowering (<span class="math inline">\(-\)</span>) operators, equivalent to <span class="math inline">\(|e\rangle\langle g|\)</span> and <span class="math inline">\(|g\rangle\langle e|\)</span> respectively</li>
</ul>
<p>To simplify the problem, we consider the total Hamiltonian (in the rotating frame)<br>
<span class="math display">\[  
H^\text{rot} = U^\dagger H_\text{a} U + U^\dagger H_\text{drv} U -i U^\dagger \frac{d}{dt} U,  
\]</span><br>
where the unitary operator is given by <span class="math inline">\(U = e^{-i \omega_L t \cdot \hat{\sigma}_z}\)</span>. The third term of <span class="math inline">\(H^\text{rot}\)</span> is simply <span class="math inline">\(-\frac{\omega_L}{2}\hat{\sigma}_z\)</span>, and the first and second terms are evaluated as:</p>
<p><span class="math display">\[
U^\dagger H_\text{a} U = \frac{\omega_a}{2}\hat{\sigma}_z,
\]</span> <span class="math display">\[
U^\dagger H_\text{drv} U = \Omega \cos(\omega_L t) \Big[e^{i\omega_L t}\hat{\sigma}^{+} + e^{-i\omega_L t}\hat{\sigma}^{-}\Big].
\]</span></p>
<p>In the weak field limit, where <span class="math inline">\(\Omega/\omega_L \ll 1\)</span>, we can drop the time-dependent part in the rotating frame through <a href="https://en.wikipedia.org/wiki/Rotating-wave_approximation">rotating-wave approximation (RWA)</a>. First, we expand <span class="math inline">\(\cos(\omega_L t)\)</span> to its exponential form, <span class="math display">\[
\Omega \cos(\omega_L t) \Big[e^{i\omega_L t}\hat{\sigma}^{+} + e^{-i\omega_L t}\hat{\sigma}^{-}\Big] = \frac{\Omega}{2}\Big[(1 + e^{2i\omega_L t})\hat{\sigma}^{+} + (1 + e^{-2i\omega_L t})\hat{\sigma}^{-}\Big]
\]</span> The time-dependent parts with frequency <span class="math inline">\(2\omega_L\)</span> are dropped, yielding <span class="math display">\[
H^\text{rot} \simeq \frac{\omega_a}{2} \hat{\sigma}_z + \frac{\Omega}{2} \hat{\sigma}_x - \frac{\omega_L}{2} \hat{\sigma}_z = \frac{\Delta}{2} \hat{\sigma}_z + \frac{\Omega}{2} \hat{\sigma}_x
\]</span> where <span class="math inline">\(\Delta \equiv \omega_a - \omega_L\)</span> is the detuning between the two-level atom and the driving light. In the realistic near-resonance case <span class="math inline">\(\Delta \simeq 0\)</span>, characteristic of the radiative behaviour remains. Thus, for the following demonstration, we only consider the exact resonance <span class="math inline">\(\Delta = 0\)</span>.</p>
<section id="dissipation-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="dissipation-dynamics">Dissipation dynamics</h3>
<p>We start by the interaction Hamiltonian between the thermal field and atom <span class="math display">\[
\hat{H}_{\text{a}}^\text{int} = \sum_l \alpha_l \left( \hat{b}_l + \hat{b}_l^\dagger \right) \left( \hat{\sigma}^{-} + \hat{\sigma}^{+} \right)
\]</span> where for the <span class="math inline">\(l\)</span>-th mode</p>
<ul>
<li><span class="math inline">\(\alpha_l\)</span> is the coupling strength with the atom</li>
<li><span class="math inline">\(\hat{b}_l\)</span> is the annihilation operator</li>
</ul>
<p>By applying <a href="https://en.wikipedia.org/wiki/Rotating-wave_approximation">rotating wave approximation (RWA)</a> and following the standard procedure of the <a href="https://en.wikiversity.org/wiki/Open_Quantum_Systems/The_Quantum_Optical_Master_Equation">Born-Markovian approximation</a>, we obtain the atom dissipation rate <span class="math inline">\(\gamma_0\)</span>. Consequently, the dynamics is described by the <a href="https://en.wikipedia.org/wiki/Lindbladian">Lindblad master equation</a>. <span class="math display">\[
\mathcal{L} = \gamma_0 n(\omega_a, T) \mathcal{D}[\hat{\sigma}^{+}] + \gamma_0 [1 + n(\omega_a, T)] \mathcal{D}[\hat{\sigma}^{-}]
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(n(\omega, T)\)</span>: Bose-Einstein distribution of the thermal field at temperature <span class="math inline">\(T\)</span></li>
<li><span class="math inline">\(\mathcal{D}[\cdot]\)</span>: The <a href="https://en.wikipedia.org/wiki/Lindbladian">Lindblad dissipator</a> (has exactly the same expression in the lab frame and the rotating frame)</li>
</ul>
</section>
</section>
<section id="code-demonstration" class="level2">
<h2 class="anchored" data-anchor-id="code-demonstration">Code Demonstration</h2>
<!-- import QuantumToolbox: QuantumObjectEvolution, n_thermal, liouvillian, sigmap, sigmam, sigmax, 
    sigmay, sigmaz, basis, mesolve, correlation_2op_1t, spectrum_correlation_fft -->
<div id="2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">using</span> <span class="bu">QuantumToolbox</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> <span class="bu">CairoMakie</span>: Figure, Axis, @L_str, lines!, axislegend, display, ylims!, xlims!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1"></a>Î© <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>Î³<span class="fl">0</span> <span class="op">=</span> <span class="fl">0.05</span> <span class="op">*</span> Î©</span>
<span id="cb2-3"><a href="#cb2-3"></a>KT <span class="op">=</span> <span class="fl">0</span> <span class="co"># thermal field at zero temperature  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0</code></pre>
</div>
</div>
<p>We define a function that returns the Liouvillian <code>SuperOperator</code> of the system.</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">function</span> <span class="fu">liouvillian_spec</span>(_Î©, _Î³<span class="fl">0</span>, _KT)</span>
<span id="cb4-2"><a href="#cb4-2"></a>    H <span class="op">=</span> _Î©<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> <span class="fu">sigmax</span>()</span>
<span id="cb4-3"><a href="#cb4-3"></a>    c_ops <span class="op">=</span> [</span>
<span id="cb4-4"><a href="#cb4-4"></a>        <span class="fu">âˆš</span>(_Î³<span class="fl">0</span> <span class="op">*</span> <span class="fu">n_thermal</span>(_Î©, _KT)) <span class="op">*</span> <span class="fu">sigmap</span>(),</span>
<span id="cb4-5"><a href="#cb4-5"></a>        <span class="fu">âˆš</span>(_Î³<span class="fl">0</span> <span class="op">*</span> (<span class="fl">1</span> <span class="op">+</span> <span class="fu">n_thermal</span>(_Î©, _KT))) <span class="op">*</span> <span class="fu">sigmam</span>(),</span>
<span id="cb4-6"><a href="#cb4-6"></a>    ]</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="cf">return</span> <span class="fu">liouvillian</span>(H, c_ops)    </span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>liouvillian_spec (generic function with 1 method)</code></pre>
</div>
</div>
<p>We first use <a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.mesolve"><code>mesolve</code></a> to solve the master equation with several observables given in <code>e_ops</code>.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1"></a>e_ket <span class="op">=</span> <span class="fu">basis</span>(<span class="fl">2</span>,<span class="fl">0</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>e_ops <span class="op">=</span> [</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="fu">sigmax</span>(),</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="fu">sigmay</span>(),</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="fu">sigmaz</span>(),</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="fu">sigmam</span>(),</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="fu">sigmap</span>(),</span>
<span id="cb6-8"><a href="#cb6-8"></a>    e_ket <span class="op">*</span> e_ket<span class="op">'</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>]</span>
<span id="cb6-10"><a href="#cb6-10"></a>Ïˆ<span class="fl">0</span> <span class="op">=</span> e_ket <span class="co"># set initial state being purely excited to better observe the radiative behaviour</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>L <span class="op">=</span> <span class="fu">liouvillian_spec</span>(Î©, Î³<span class="fl">0</span>, KT)</span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="fu">print</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Quantum Object:   type=SuperOperator   dims=[2]   size=(4, 4)
4Ã—4 SparseMatrixCSC{ComplexF64, Int64} with 12 stored entries:
 -0.05+0.0im     0.0-0.5im     0.0+0.5im      â‹…    
   0.0-0.5im  -0.025+0.0im         â‹…      0.0+0.5im
   0.0+0.5im         â‹…      -0.025+0.0im  0.0-0.5im
  0.05+0.0im     0.0+0.5im     0.0-0.5im      â‹…    </code></pre>
</div>
</div>
<p>We already generate the Liouvillian with <code>c_ops</code> included above. We donâ€™t need to specify the <code>c_ops</code> again in <a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.mesolve"><code>mesolve</code></a>:</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1"></a>tlist <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">20</span>  </span>
<span id="cb8-2"><a href="#cb8-2"></a>sol <span class="op">=</span> <span class="fu">mesolve</span>(L, Ïˆ<span class="fl">0</span>, tlist, <span class="cn">nothing</span>, e_ops <span class="op">=</span> e_ops)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progress: [                              ]   0.5% --- Elapsed Time: 0h 00m 02s (ETA: 0h 06m 40s)Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 02s (ETA: 0h 00m 00s)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 6
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6</code></pre>
</div>
</div>
<p>By observing the expectation values of the Pauli operators, we see that the Bloch vector <span class="math inline">\((\langle \hat{\sigma}_x \rangle, \langle \hat{\sigma}_y \rangle, \langle \hat{\sigma}_z \rangle)\)</span> becomes shorter over time, which is consistent with the dissipative behaviour. Also, the population of the excited state <span class="math inline">\(|e\rangle\)</span> has an oscillation amplitude decaying over time.</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1"></a>expect <span class="op">=</span> <span class="fu">real</span>.(sol.expect)</span>
<span id="cb11-2"><a href="#cb11-2"></a>fig1 <span class="op">=</span> <span class="fu">Figure</span>(size <span class="op">=</span> (<span class="fl">600</span>,<span class="fl">300</span>))</span>
<span id="cb11-3"><a href="#cb11-3"></a>ax11 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb11-4"><a href="#cb11-4"></a>    fig1[<span class="fl">1</span>,<span class="fl">1</span>]</span>
<span id="cb11-5"><a href="#cb11-5"></a>)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="fu">lines!</span>(ax11, tlist, expect[<span class="fl">1</span>,<span class="op">:</span>], label <span class="op">=</span> L<span class="st">"\langle \hat{\sigma}_x </span><span class="sc">\r</span><span class="st">angle"</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="fu">lines!</span>(ax11, tlist, expect[<span class="fl">2</span>,<span class="op">:</span>], label <span class="op">=</span> L<span class="st">"\langle \hat{\sigma}_y </span><span class="sc">\r</span><span class="st">angle"</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="fu">lines!</span>(ax11, tlist, expect[<span class="fl">3</span>,<span class="op">:</span>], label <span class="op">=</span> L<span class="st">"\langle \hat{\sigma}_z </span><span class="sc">\r</span><span class="st">angle"</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="fu">axislegend</span>(ax11)</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="fu">ylims!</span>(ax11, (<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>))</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a>ax12 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb11-13"><a href="#cb11-13"></a>    fig1[<span class="fl">2</span>,<span class="fl">1</span>],</span>
<span id="cb11-14"><a href="#cb11-14"></a>    xlabel <span class="op">=</span> L<span class="st">"time </span><span class="sc">$</span><span class="st">[1/\</span>Omega<span class="st">]</span><span class="sc">$</span><span class="st">"</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="st">)</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>lines<span class="st">!(ax12, tlist, expect[6,:], label = L"</span>P_e<span class="st">")</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="fu">axislegend</span>(ax12)</span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="fu">ylims!</span>(ax12, (<span class="fl">0</span>,<span class="fl">1</span>))</span>
<span id="cb11-19"><a href="#cb11-19"></a></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="fu">display</span>(fig1);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fluorescence_files/figure-html/cell-7-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Further, we check the effect of different values of the damping rate. Note that despite these dissipation rates looked enormous at first glance, it is still to the order of the field strength and therefore considered dissipative for the system in the lab frame.</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1"></a>results <span class="op">=</span> []</span>
<span id="cb12-2"><a href="#cb12-2"></a>Î³<span class="fl">0</span>s <span class="op">=</span> Î© <span class="op">.*</span> [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>]</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="cf">for</span> Î³<span class="fl">0</span> <span class="kw">in</span> Î³<span class="fl">0</span>s</span>
<span id="cb12-4"><a href="#cb12-4"></a>    result <span class="op">=</span> <span class="fu">mesolve</span>(<span class="fu">liouvillian_spec</span>(Î©, Î³<span class="fl">0</span>, KT), Ïˆ<span class="fl">0</span>, tlist, <span class="cn">nothing</span>, e_ops <span class="op">=</span> e_ops)</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="fu">push!</span>(results, (Î³<span class="fl">0</span> <span class="op">=</span> Î³<span class="fl">0</span>, expect <span class="op">=</span> result.expect))</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)</code></pre>
</div>
</div>
<p>The expectation values dynamics of <span class="math inline">\(\hat{\sigma}^{+}\)</span> and <span class="math inline">\(\hat{\sigma}^{-}\)</span> shows the driving-field-induced dipole moment of the atom oscillates and persists.</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1"></a>fig2 <span class="op">=</span> <span class="fu">Figure</span>(size <span class="op">=</span> (<span class="fl">600</span>,<span class="fl">300</span>))</span>
<span id="cb14-2"><a href="#cb14-2"></a>ax2 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb14-3"><a href="#cb14-3"></a>    fig2[<span class="fl">1</span>,<span class="fl">1</span>],</span>
<span id="cb14-4"><a href="#cb14-4"></a>    xlabel <span class="op">=</span> L<span class="st">"time </span><span class="sc">$</span><span class="st">[1/\</span>Omega<span class="st">]</span><span class="sc">$</span><span class="st">",</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">    </span>title<span class="st"> = L"</span><span class="op">\</span>langle<span class="op">\</span>hat{<span class="op">\</span>sigma}_{<span class="op">+</span>}<span class="op">\</span>rangle<span class="st">"</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>)</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="cf">for</span> (Î³<span class="fl">0</span>, expect) <span class="kw">in</span> results</span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="fu">lines!</span>(ax2, tlist, <span class="fu">imag</span>(expect[<span class="fl">5</span>,<span class="op">:</span>]), label <span class="op">=</span> <span class="st">"Î³0 = </span><span class="sc">$</span><span class="st">Î³0")</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>end</span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="fu">axislegend</span>(ax2)</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="fu">display</span>(fig2);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fluorescence_files/figure-html/cell-9-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1"></a>fig3 <span class="op">=</span> <span class="fu">Figure</span>(size <span class="op">=</span> (<span class="fl">600</span>,<span class="fl">300</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a>ax3 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>    fig3[<span class="fl">1</span>,<span class="fl">1</span>],</span>
<span id="cb15-4"><a href="#cb15-4"></a>    xlabel <span class="op">=</span> L<span class="st">"time </span><span class="sc">$</span><span class="st">[1/\</span>Omega<span class="st">]</span><span class="sc">$</span><span class="st">",</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="st">    </span>title<span class="st"> = L"</span><span class="op">\</span>langle<span class="op">\</span>hat{<span class="op">\</span>sigma}_{<span class="op">-</span>}<span class="op">\</span>rangle<span class="st">"</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>)</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="cf">for</span> (Î³<span class="fl">0</span>, expect) <span class="kw">in</span> results</span>
<span id="cb15-9"><a href="#cb15-9"></a>    <span class="fu">lines!</span>(ax3, tlist, <span class="fu">imag</span>(expect[<span class="fl">4</span>,<span class="op">:</span>]), label <span class="op">=</span> <span class="st">"Î³0 = </span><span class="sc">$</span><span class="st">Î³0")</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>end</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="fu">axislegend</span>(ax3)</span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="fu">display</span>(fig3);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fluorescence_files/figure-html/cell-10-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We now move to the analysis of the correlation function <span class="math inline">\(C(\tau) = \langle \hat{\sigma}^{+}(\tau) \hat{\sigma}^{-}(0)\rangle\)</span>, which describes the radiative behaviour of the atom towards its surrounding environment. Using <a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.correlation_2op_1t"><code>correlation_2op_1t</code></a>, we can obtain the correlation function as a function of <span class="math inline">\(\tau\)</span> and use <a href="https://qutip.org/QuantumToolbox.jl/stable/resources/api#QuantumToolbox.spectrum_correlation_fft"><code>spectrum_correlation_fft</code></a> to obtain the corresponding Fourier transform.</p>
<div id="20" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1"></a>fig4 <span class="op">=</span> <span class="fu">Figure</span>(size <span class="op">=</span> (<span class="fl">600</span>,<span class="fl">300</span>))</span>
<span id="cb16-2"><a href="#cb16-2"></a>ax41 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>    fig4[<span class="fl">1</span>,<span class="fl">1</span>],</span>
<span id="cb16-4"><a href="#cb16-4"></a>    xlabel <span class="op">=</span> L<span class="st">"</span><span class="sc">\t</span><span class="st">au"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>    title <span class="op">=</span> L<span class="st">"C(</span><span class="sc">\t</span><span class="st">au)"</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a>ax42 <span class="op">=</span> <span class="fu">Axis</span>(</span>
<span id="cb16-9"><a href="#cb16-9"></a>    fig4[<span class="fl">1</span>,<span class="fl">2</span>],</span>
<span id="cb16-10"><a href="#cb16-10"></a>    xlabel <span class="op">=</span> L<span class="st">"\omega"</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>    ylabel <span class="op">=</span> <span class="st">"fft amplitude"</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>)</span>
<span id="cb16-13"><a href="#cb16-13"></a>Ï„list <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">100</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="cf">for</span> Î³<span class="fl">0</span> <span class="kw">in</span> Î³<span class="fl">0</span>s</span>
<span id="cb16-15"><a href="#cb16-15"></a>    L <span class="op">=</span> <span class="fu">liouvillian_spec</span>(Î©, Î³<span class="fl">0</span>, KT)    </span>
<span id="cb16-16"><a href="#cb16-16"></a>    corr <span class="op">=</span> <span class="fu">correlation_2op_1t</span>(L, Ïˆ<span class="fl">0</span>, Ï„list, <span class="cn">nothing</span>, <span class="fu">sigmap</span>(), <span class="fu">sigmam</span>())</span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a>    <span class="fu">lines!</span>(ax41, Ï„list, <span class="fu">real</span>(corr), label <span class="op">=</span> <span class="st">"Î³0 = </span><span class="sc">$</span><span class="st">Î³0")</span></span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="st">    </span>fft_<span class="st">Ï‰list, fft_spect = spectrum_correlation_fft(Ï„list, corr)</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>    <span class="fu">lines!</span>(ax42, fft_Ï‰list, fft_spect, label <span class="op">=</span> <span class="st">"Î³0 = </span><span class="sc">$</span><span class="st">Î³0")</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>end</span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="fu">xlims!</span>(ax42, (<span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>))</span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="fu">axislegend</span>(ax41)</span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="fu">axislegend</span>(ax42)</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="fu">display</span>(fig4);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)
Progress: [==============================] 100.0% --- Elapsed Time: 0h 00m 00s (ETA: 0h 00m 00s)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fluorescence_files/figure-html/cell-11-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the above plots, one finds that the correlation functions decay faster with higher dissipation rate, and therefore the lower spectral peaks. On the other hand, the higher spectral peaks means the radiation is brighter in terms of intensity.</p>
</section>
<section id="version-information" class="level2">
<h2 class="anchored" data-anchor-id="version-information">Version Information</h2>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">import</span> <span class="bu">QuantumToolbox</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>QuantumToolbox.<span class="fu">versioninfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 QuantumToolbox.jl: Quantum Toolbox in Julia
â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡â‰¡
Copyright Â© QuTiP team 2022 and later.
Current admin team:
    Alberto Mercurio and Yi-Te Huang

Package information:
====================================
Julia              Ver. 1.11.3
QuantumToolbox     Ver. 0.25.2
SciMLOperators     Ver. 0.3.12
LinearSolve        Ver. 2.38.0
OrdinaryDiffEqCore Ver. 1.15.1

System information:
====================================
OS       : Linux (x86_64-linux-gnu)
CPU      : 4 Ã— AMD EPYC 7763 64-Core Processor
Memory   : 15.615 GB
WORD_SIZE: 64
LIBM     : libopenlibm
LLVM     : libLLVM-16.0.6 (ORCJIT, znver3)
BLAS     : libopenblas64_.so (ilp64)
Threads  : 4 (on 4 virtual cores)
</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/qutip\.org\/qutip-julia-tutorials\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright Â© 2025 <a href="https://qutip.org/" target="_blank"><strong>QuTiP.org</strong></a>.</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/qutip/qutip-julia-tutorials/edit/main/QuantumToolbox.jl/time_evolution/fluorescence.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/qutip/qutip-julia-tutorials/blob/main/QuantumToolbox.jl/time_evolution/fluorescence.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/qutip/qutip-julia-tutorials/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>